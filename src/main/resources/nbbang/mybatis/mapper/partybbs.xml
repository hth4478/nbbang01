<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="nbbang.mybatis.mapper.partybbs">

	<resultMap type="partyBbsDTO" id="partyBbsDTOResult">
		<result column="partyNo" property="partyNo"/>
		<result column="partyTitle" property="partyTitle"/>
		<result column="partyContent" property="partyContent"/>
		<result column="partyPostdate" property="partyPostdate"/>
		<result column="partyMaxCapacity" property="partyMaxCapacity"/>
		<result column="partyActivation" property="partyActivation"/>
		<result column="partyAllotmentPrice" property="partyAllotmentPrice"/>
		<result column="partyCategoryName" property="partyCategoryName"/>
		<result column="partyMembership" property="partyMembership"/>
		<result column="email" property="email"/>
		<result column="partyMatchdate" property="partyMatchdate"/>
		<result column="partyMember" property="partyMatchdate"/>
	</resultMap>

	<select id="partyBbsSelectList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end}
	</select>
	
	<select id="netplixList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end} AND partyCategoryName = 'netplix'
	</select>
	
	<select id="whatchaList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end} AND partyCategoryName = 'whatcha'
	</select>
	
	<select id="disneyList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end} AND partyCategoryName = 'disney'
	</select>
	
	<select id="laftelList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end} AND partyCategoryName = 'laftel'
	</select>
	
	<select id="tvingList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end} AND partyCategoryName = 'tving'
	</select>
	
	<select id="wavveList" parameterType="Map" resultType="partyBbsDTO">
		SELECT * FROM 
		(SELECT T.*, ROWNUM R FROM 
			(SELECT p.*, m.nickname, m.profile, m.oringinprofile FROM 
				partybbs p JOIN member m ON m.email = p.email
				ORDER BY partyactivation DESC, partyno DESC) T)
		WHERE R BETWEEN #{start} AND #{end} AND partyCategoryName = 'wavve'
	</select>
	
	<select id="partyBbsTotalRowCount" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM partybbs p JOIN member m ON m.email = p.email
	</select>
<!-- 	
	<select id="selectPartyMember" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM partymember WHERE partyno = #{partyNo}
	</select>
 -->
	<insert id="partyBbsInsert" parameterType="Map">
		INSERT INTO partybbs
		VALUES(SEQ_partybbs_partyno.NEXTVAL,#{partyTitle},
		#{partyContent},SYSDATE,#{partyMaxCapacity},#{partyActivation},
		#{partyAllotmentPrice},#{partyCategoryName},#{partyMembership},#{email},null)
	</insert>
	
	<delete id="partyBbsDelete" parameterType="Map">
		DELETE partybbs WHERE partyno = #{partyNo}
	</delete>
	
</mapper> 